<div class="card">
  <div class="card-body">
    <div id="chart_{{ request.headers['hx-target'] }}"></div>
  </div>
  <script>
    window["{{request.headers['hx-target']}}-var"] = new ApexCharts(
      document.getElementById("chart_{{request.headers['hx-target']}}"),
      {
        chart: {type: 'line', height: 350},
        labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sept", "Oct", "Nov", "Dec"],
        noData: {
          text: 'No Data'
        },
        series: []
      }
    );
    window["{{request.headers['hx-target']}}-var"].render()

    var url = '/api/chart/sla-breach/products?env_id={{env_id}}';

    $.getJSON(url, function(response) {
      window["{{request.headers['hx-target']}}-var"].updateSeries(response)
    });

    $("#product-name-selector").change(function() {
      var selectedValue = $(this).val();
      var updatedUrl = url + "&severity=" + encodeURIComponent(selectedValue);
      $.getJSON(updatedUrl, function(response) {
        window["{{request.headers['hx-target']}}-var"].updateSeries(response)
      });
    })
  </script>
</div>
