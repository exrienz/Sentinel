{% set title = 'Threat Intelligence Dashboard' %}
{% set filename = '/thread-intelligence' %}

{% extends 'layouts/master.html' %}
{% block content %}
<div class="page-heading">
  <h3>OSINT Threat-Intel Dashboard</h3>
</div>
<div class="page-content">
  <section class="row">
    <div class="col-sm-6">
      <div class="card">
        <div class="card-header">
          <h4>Latest Nessus CVE Feed</h4>
        </div>
        <div class="card-body">
          <table class="table table-striped mt-4">
            <thead>
              <tr>
                <th>Date</th>
                <th>Title</th>
                <th>Description</th>
              </tr>
            </thead>
            <tbody hx-trigger="load" hx-get="newest-cve"></tbody>
          </table>
        </div>
      </div>
    </div>
    <div class="col-sm-6">
      <div class="col-12">
        <div class="card">
          <div class="card-header">
            <h4>Product/Service Tracker</h4>
          </div>
          <div class="card-body">
            <!-- No Labels Form -->
            <div class="form-group with-title mb-3">
              <textarea class="form-control" id="search" rows="3">Google Chrome,Jenkins,Gitlab</textarea>
              <label>Example Format: host/ip, host/ip, ...</label>
            </div>
            <div class="text-center">
              <button type="submit" name="createAssessment" class="btn btn-primary">Update</button>
              <button type="reset" class="btn btn-secondary">Reset</button>
            </div>
            <!-- End No Labels Form -->
          </div>
        </div>
      </div>

      <div class="col-12">
        <div class="card">
          <div class="card-header">
            <h4>RSS Security Headlines</h4>
          </div>
          <div class="card-body">

            <script type="text/javascript">
              rssfeed_url = new Array();
              rssfeed_url[0] = "https://feeds.feedburner.com/TheHackersNews"; rssfeed_url[1] = "https://news.sophos.com/en-us/feed/"; rssfeed_url[2] = "http://feeds.feedburner.com/Securityweek"; rssfeed_url[3] = "https://gbhackers.com/feed/"; rssfeed_url[4] = "https://www.cybersecurity-insiders.com/feed/";
              rssfeed_frame_width = "100%";
              rssfeed_frame_height = "1500";
              rssfeed_scroll = "on";
              rssfeed_scroll_step = "2";
              rssfeed_scroll_bar = "on";
              rssfeed_target = "_blank";
              rssfeed_font_size = "18";
              rssfeed_font_face = "";
              rssfeed_border = "on";
              rssfeed_css_url = "https://feed.surfing-waves.com/css/style1.css";
              rssfeed_title = "on";
              rssfeed_title_name = "";
              rssfeed_title_bgcolor = "#3366ff";
              rssfeed_title_color = "#fff";
              rssfeed_title_bgimage = "";
              rssfeed_footer = "off";
              rssfeed_footer_name = "rss feed";
              rssfeed_footer_bgcolor = "#fff";
              rssfeed_footer_color = "#333";
              rssfeed_footer_bgimage = "";
              rssfeed_item_title_length = "50";
              rssfeed_item_title_color = "#666";
              rssfeed_item_bgcolor = "#fff";
              rssfeed_item_bgimage = "";
              rssfeed_item_border_bottom = "on";
              rssfeed_item_source_icon = "on";
              rssfeed_item_date = "off";
              rssfeed_item_description = "on";
              rssfeed_item_description_length = "120";
              rssfeed_item_description_color = "#666";
              rssfeed_item_description_link_color = "#333";
              rssfeed_item_description_tag = "off";
              rssfeed_no_items = "0";
              rssfeed_cache = "442e5e59ef94437919d9bca0d507d792";
            </script>
            <script type="text/javascript" src="//feed.surfing-waves.com/js/rss-feed.js"></script>
            <div style="color:#ccc;font-size:10px; text-align:right; width:100%px;">powered by <a
                href="https://surfing-waves.com" rel="noopener" target="_blank" style="color:#ccc;">Surfing Waves</a>
            </div>
          </div>
        </div>
      </div>

    </div>
  </section>
</div>
{% endblock %}
{% block js%}
<script>
  const textarea = document.getElementById('search');

  textarea.addEventListener('input', () => {
    const rows = document.querySelectorAll('tbody tr');
    const text = textarea.value.toLowerCase();

    rows.forEach(row => {
      const rowText = row.textContent.toLowerCase();
      if (rowText.includes(text) && text.trim() !== '') {
        row.classList.add('table-success');
        console.log(row)
      } else {
        row.classList.remove('table-success');
      }
    });
  });
</script>
{% endblock %}
